---
title: "code BLIZ"
author: "Leticia Duarte"
output: 
  html_notebook:
    toc: true
    toc_float: true
editor_options: 
  chunk_output_type: inline
---

<style type="text/css">

body{ /* Normal  */
      font-size: 13px;
  }
td {  /* Table  */
  font-size: 12px;
}
h1.title {
  font-size: 20px;
  font-weight: bold;
}
h1 { /* Header 1 */
  font-size: 20px;
  font-weight: bold;
}
h2 { /* Header 2 */
    font-size: 17px;
  font-weight: bold;
}
h3 { /* Header 3 */
    font-size: 15px;
  font-weight: bold;
}
code.r{ /* Code block */
    font-size: 12px;
}
pre{ /* Code block - determines code spacing between lines */
    font-size: 12px;
}
h1, .h1, h2, .h2, h3, .h3, h4, .h4 {
    margin-top: 24xpx;
}
</style>


# Summary of the analyses

In **Step 1**, we prepared the candidate species for both Bavaria and Baden-Württemberg (BW).

- For Bavaria we used the species found in https://www.lfu.bayern.de/natur/rote_liste_pflanzen/doc/pflanzen/rl_pflanzen_nach_kategorien.pdf

- For both Bavaria and BW we went to https://www.gbif.org/occurrence/search?occurrence_status=present&q= to download the species list with occurrences, and used the following filters: 
  - "Scientific name" - "Tracheophyta"
  - "Location" - "Including coordinates"
  - "Administrative areas" - "Bayern" or Baden-Württemberg"
  

In **Step 2** we looked for the available traits and checked which species had information for all traits.

For each trait we did the following steps:

- Download data
- Check units and methods used, and filter the useful data
- Select the columns with the measurements, methods and units
- Format data
- Merge data with the candidate species list prepared in Step 1

After checking and preparing all traits (Seed number, Growth rate, Wetmass, and Dispersal distance), we joined them, in order to see which species had information for them &rarr; **Complete data**

But because wetmass was a limiting variable, I decided to do a second compilation with species that had information for drymass in case there's a formula to convert drymass to wetmass &rarr; **Extra data**

We calculated mortality rate using an allometric equation with wetmass.

For carrying capacity (or max planting density), we had to search manually in FloraWeb and articles, since this trait did not appear in any databases.


Finally, we formatted all the data to compile information for the chosen species in one table.


In **Step 3**, we calculated the number of occurrences for the chosen species.


In **Step 4**, we mapped the occurrence data of the chosen species


Detailed information about each step can be found in the code below.

<span style="color: darkorange;">All data files necessary can be found in https://drive.google.com/drive/folders/1x93UjAnduPXwROqXVnQeJ4JQbdVoKeom?usp=sharing


# 1 - Candidate species


## Species from Bavaria

Download red list of vascular plants from Bavaria (https://www.lfu.bayern.de/natur/rote_liste_pflanzen/doc/pflanzen/rl_pflanzen_nach_kategorien.pdf) and convert to csv

```{r}

plants_bavaria <- readLines("Data/Rote_List_Bayern.csv") #read csv as a text object

simplified_plants = paste(plants_bavaria, collapse = " ") #simplify data by collapsing everything with a space as delimiter

#run a for loop where we are looking for every "space + capital letter" and want to replace with a "new line + capital letter" - this was necessary because we had multiple species listed in one row
for (x in LETTERS) {
simplified_plants = gsub(paste0(" ",x), paste0("\n",x), simplified_plants)
}

#formatting data
sp_bavaria_red = 
  simplified_plants |>
  strsplit(split = "\n") |> #split lines in substrings
  unlist() |>
  gsub(paste0(" ","´"), paste0(""), x = _) |> #fix text (eliminate "´")
  gsub(paste0(" ","x"), paste0(""), x = _) |> #fix text (eliminate "x")
  unique() #remove duplicates

sp_bavaria_red <- data.frame(sp_bavaria_red) #transform into dataframe
colnames(sp_bavaria_red) <- c('species') #change name of id column

```


Download list of species with occurrences in Bavaria from GBIF database (https://www.gbif.org/occurrence/search?occurrence_status=present&q=), and use the following filters: 
  - "Scientific name" - "Tracheophyta"
  - "Location" - "Including coordinates"
  - "Administrative areas" - "Bayern"
  
Download - option "species list"
  
(All occurrence data in BIEN is from GBIF, so there was no need to use both databases)
  
```{r}

GBIF_bav <- read.csv("Data/SpeciesList_Bavaria.csv", sep = "\t") #read file

sp_bav <- GBIF_bav[c("species")] #select column with species names
sp_bav <- sp_bav[sp_bav$species != "", , drop=FALSE] #eliminate empty rows

```


## Species from Baden-Württemberg (BW)

Download list of species with occurrences in BW from GBIF database (https://www.gbif.org/occurrence/search?occurrence_status=present&q=), and use the following filters: 
  - "Scientific name" - "Tracheophyta"
  - "Location" - "Including coordinates"
  - "Administrative areas" - "Baden-Württemberg"
  
Download - option "species list"

```{r}

GBIF_baden <- read.csv("Data/SpeciesList_Baden.csv", sep = "\t") #read file

sp_baden <- GBIF_baden[c("species")] #select column with species names
sp_baden <- sp_baden[sp_baden$species != "", , drop=FALSE]#eliminate empty rows

```

## Candidate species list

```{r}

GBIF_Species <- merge(sp_bav,sp_baden, by = "species", all = TRUE) #merge both lists from GBIF
BB_Species <- merge(GBIF_Species,sp_bavaria_red, by = "species", all = TRUE) #merge GBIF data with Red List data

length(unique(BB_Species$species)) #calculate number of candidate species

```

# 2 - Traits

## Number of Seeds - reproductive rate

Download "Seed number" file from LEDA database (https://uol.de/en/landeco/research/leda/data-files)
Files (.txt) from this database have formatting problems - need to remove manually the first few rows to be read

**Brief summary:**
Filtered only values with **reproduction.unit.measured = 'per ramet/tussock or individual plant '** <span style="color: red;">&rarr; Check if you want me to consider other units. </span> For the methods used, considered all of them <span style="color: red;">&rarr; Check if you want me to only consider some. </span>

```{r}

seed_number <- read.csv2("Data/seed_number.txt", quote = "", dec = ".") #read file

unique(seed_number$reproduction.unit.measured) #check units measured
unique(seed_number$general.method) #check methods used

SeedNumber <- subset(seed_number, reproduction.unit.measured == 'per ramet/tussock or individual plant ') #filter rows with reproduction.unit.measured = 'per ramet/tussock or individual plant '
SeedNumber <- SeedNumber[c("SBS.name","single.value","general.method","reproduction.unit.measured")] #select columns with species, values, methods and units
names(SeedNumber)[names(SeedNumber) == 'SBS.name'] <- 'species' #change column name
names(SeedNumber)[names(SeedNumber) == 'single.value'] <- 'seed_number' #change column name

str(SeedNumber) #check if values are all numeric

merge_seeds <- merge(BB_Species, SeedNumber, by = "species") #merge data with candidate species list

length(unique(merge_seeds$species)) #check the number of species with data for this trait

```

## Growth Rate

Download "587 - plant growth rate" from TRY database (https://www.try-db.org/TryWeb/Home.php)

**Brief summary:**
Filtered only values with **method = 'ann. rad. gr'** and with **unit = "mm"**, in order to be consistent <span style="color: red;">&rarr; Check if you want me to consider other units.</span>

```{r}

growth_rate <- read.delim("Data/PlantGrowthRate.txt") #read file

GrowthRate <- subset(growth_rate, TraitID == 587) # filter rows with growth rate values - the database has other information

unique(GrowthRate$OrigUnitStr) #check units measured
unique(GrowthRate$OriglName) #check methods used

GrowthRate <- subset(GrowthRate, OrigUnitStr == 'mm' & OriglName == 'ann. rad. gr') #filter rows with OrigUnitStr = "mm" and OriglName = "ann. rad.gr"
GrowthRate <- GrowthRate[c("AccSpeciesName","OriglName","OrigValueStr","OrigUnitStr")] #select columns with species, values, methods and units
names(GrowthRate)[names(GrowthRate) == 'AccSpeciesName'] <- 'species' #change name
names(GrowthRate)[names(GrowthRate) == 'OriglName'] <- 'growth_method' #change name
names(GrowthRate)[names(GrowthRate) == 'OrigValueStr'] <- 'growth_rate_mm' #change name
names(GrowthRate)[names(GrowthRate) == 'OrigUnitStr'] <- 'growth_unit' #change name

str(GrowthRate) #check if values are all numeric

#if not numeric, go check if any values are wrong
#edit the wrong values (there was a value with "o.5" instead of "0.5" & "0.2.5" instead of "0.25"
GrowthRate$growth_rate_mm = gsub("o", "0", GrowthRate$growth_rate_mm, fixed = TRUE)
GrowthRate$growth_rate_mm = gsub("0.2.5", "0.25", GrowthRate$growth_rate_mm, fixed = TRUE)

GrowthRate$growth_rate_mm <- as.numeric(GrowthRate$growth_rate_mm) #convert column with values to numeric instead of character

merge_growth <- merge(BB_Species, GrowthRate, by = "species") #merge data with candidate species list

length(unique(merge_growth$species)) #check the number of species with data for this trait

```



## Wetmass

Download "3025 - plant wet biomass" from TRY database (https://www.try-db.org/TryWeb/Home.php)

Brief summary:
Didn't need to filter units or methods because they were all the same (g and whole plant fresh mass).

```{r}

plant_fresh_mass <- read.delim("Data/PlantFreshMass.txt") #read file

PlantFreshMass <- subset(plant_fresh_mass, TraitID == 3407) #filter rows with fresh mass values - the database has other information

unique(PlantFreshMass$OrigUnitStr) #check units measured
unique(PlantFreshMass$DataName) #check methods used

PlantFreshMass <- PlantFreshMass[c("AccSpeciesName","DataName","OrigValueStr","OrigUnitStr")] #select columns with species, values, methods and units
names(PlantFreshMass)[names(PlantFreshMass) == 'AccSpeciesName'] <- 'species' #change name
names(PlantFreshMass)[names(PlantFreshMass) == 'DataName'] <- 'P_part' #change name
names(PlantFreshMass)[names(PlantFreshMass) == 'OrigValueStr'] <- 'wetmass_g' #change name
names(PlantFreshMass)[names(PlantFreshMass) == 'OrigUnitStr'] <- 'Unit' #change name

str(PlantFreshMass) #check if values are all numeric
#if not numeric, go check if any values are wrong (no problems)
PlantFreshMass$wetmass_g <- as.numeric(PlantFreshMass$wetmass_g) #convert column with values to numeric instead of character

merge_fresh_mass <- merge(BB_Species, PlantFreshMass, by = "species") #merge data with candidate species list

```


Download data from Supporting Information of "PlantNE: a global database of plant biomass from nitrogen-addition experiments" (https://esajournals.onlinelibrary.wiley.com/doi/full/10.1002/ecy.2840)

**Brief summary:**
Used the biomass data from the control groups used in this study (column CK_M) <span style="color: red;">&rarr; Check if it's okay to consider these values.</span>
Filtered data with unit "g" and "g " because they are the same, and to be consistent.

```{r}

plantNE_data <- read.csv("Data/PlantNE_Biomass.csv", dec = ".") #read file

unique(plantNE_data$Unit) #check units measured
unique(plantNE_data$P_part) #check part of the plant measured

plantNE <- subset(plantNE_data, Unit %in% c('g','g ') & P_part == 'WP') #filter rows with unit = "g" and plant part = "whole plant"
plantNE <- plantNE[c("Species","CK_M","Unit","P_part")] #select columns with species, values, methods and units
names(plantNE)[names(plantNE) == 'Species'] <- 'species' #change name
names(plantNE)[names(plantNE) == 'CK_M'] <- 'wetmass_g' #change name

str(plantNE) #check if values are all numeric

merge_plantNE <- merge(BB_Species, plantNE, by = "species") #merge data with candidate species list

```

Join data from both databases

```{r}

Wetmass <- rbind(PlantFreshMass, plantNE)

length(unique(Wetmass$species)) #check the number of species with data for this trait

```

## Mortality rate

Mortality rate was calculated from biomass with the allometric equation from Marba, N., Duarte, C.M. & Agustí S. (2007) Allometric scaling of plant life history. Proceedings of the National Academy of Sciences of the United States of America, 104, 15777–15780. (https://www.pnas.org/doi/abs/10.1073/pnas.0703476104)

“Marba et al. (2007)  applied allometric theory to the relationship between size and important life-history parameters and reported that mortality and birth rates scaled as **the –0.25 power and life span as the 0.25 power of plant mass from phytoplankton to trees**.” (https://besjournals.onlinelibrary.wiley.com/doi/full/10.1111/j.1365-2745.2008.01415.x) 


```{r}

Wetmass$mortality = -0.25^Wetmass$wetmass_g #calculate mortality from wetmass

```


## Dispersal Distance

Download data from the Supporting Information of "Seed dispersal distance classes and dispersal modes for the European flora" (https://onlinelibrary.wiley.com/doi/full/10.1111/geb.13712)

**This article has the data in dispersal classes:**

Dispersal distance classes from Vittoz, P., & Engler, R. (2007). Seed dispersal distances: A typology based on dispersal modes and plant traits. Botanica Helvetica, 117, 109–124.

(dispersal distances in m for 50 and 99% seeds)

- class 1: 0.1-1 m

- class 2: 1-5 m

- class 3: 2-15 m

- class 4: 40-150 m

- class 5: 10-500 m

- class 6: 400-1500 m 

- (class 7: 500-5000 m - **excluded this class because it's dispersal by humans and that data exists only for some species**)

**&rarr; Used the 99% distribution kernels as the maximum distance**

**&rarr; Used the 50% distribution kernels as the mean distance**

```{r}

dispersal <- read.csv2("Data/Lososova_et_al_2023_Dispersal.csv") #read file

Dispersal <- dispersal[c("Taxon","Dispersal.distance.class..1.6.")] #select columns with species and dispersal class
names(Dispersal)[names(Dispersal) == 'Taxon'] <- 'species' #change name
names(Dispersal)[names(Dispersal) == 'Dispersal.distance.class..1.6.'] <- 'dispersal_class_1-6' #change name

##convert class data in mean distance and max distance
dispersal_key = read.csv("Data/dispersal_classes.csv") #read file with dispersal classes and respective mean and max values

#assign max and mean values for each row
for (row in seq_len(nrow(dispersal_key))) {
    curr_class = dispersal_key[row, "class"]
    curr_mean = dispersal_key[row, "mean_dist_m"]
    curr_max = dispersal_key[row, "max_dist_m"]
    
    Dispersal$mean_dist_m[Dispersal$'dispersal_class_1-6' == curr_class] = curr_mean
    Dispersal$max_dist_m[Dispersal$'dispersal_class_1-6' == curr_class] = curr_max
}

str(Dispersal) #check if values are all numeric

merge_dispersal <- merge(BB_Species, Dispersal, by = "species") #merge data with candidate species list

length(unique(merge_dispersal$species)) #check the number of species with data for this trait


```

# 2.1 - Join all trait data

This includes: seed number, growth rate, wetmass from TRY and PlantNE databases, mortality, and maximum and mean dispersal distances

Carrying capacity wasn't included yet because it has to be checked manually, and for that we need to check first which species have data for the other traits.

```{r}

traits <- 
  BB_Species |> 
  merge(SeedNumber, by = "species") |> 
  merge(GrowthRate, by = "species") |>
  merge(Wetmass, by = "species") |>
  merge(Dispersal, by = "species")
  
unique(traits$species)  #check the number of species with data for all traits

```


# 2.2 - Carrying capacity
= maximum planting density

Download "601 - Species tolerance to planting density" from TRY database (https://www.try-db.org/TryWeb/Home.php)

This same data exists in FloraWeb.


```{r}

density <- read.delim("Data/planting_density.txt") #read file

PDensity_try <- subset(density, DataID == 1320) # filter rows with maximum planting density - the database has other information

unique(PDensity_try$OrigUnitStr) #check units measured

PDensity_try <- PDensity_try[c("AccSpeciesName","OriglName","OrigValueStr","OrigUnitStr")] #select columns with species, values, methods and units
names(PDensity_try)[names(PDensity_try) == 'AccSpeciesName'] <- 'species' #change name
names(PDensity_try)[names(PDensity_try) == 'OriglName'] <- 'density_method' #change name
names(PDensity_try)[names(PDensity_try) == 'OrigValueStr'] <- 'density_acre' #change name
names(PDensity_try)[names(PDensity_try) == 'OrigUnitStr'] <- 'density_unit' #change name

str(PDensity_try) #check if values are all numeric

merge_density <- merge(BB_Species, PDensity_try, by = "species") #merge data with candidate species list

length(unique(merge_density$species)) #check the number of species with data for this trait


#convert plants/acre to plants/m2
# 1 acre = 4046.86 m2
PDensity_try$density_sqMeter = PDensity_try$density_acre/4046.86

```

For the rest of the species, search for data in papers. 

```{r}

PDensity_manual <- read.csv2("Data/PDensity_manual.csv") #read file with carrying capacity data searched manually


PDensity <- rbind(PDensity_try[c(1,4:5)], PDensity_manual[c(1:3)], deparse.level = 0) #create table with all carrying capacity data


```


References for the carrying capacity data searched manually:

- Centaurea diffusa: https://www.fs.usda.gov/database/feis/plants/forb/cendif/all.pdf

- Galium mollugo: https://cdnsciencepub.com/doi/pdf/10.4141/P01-152
<span style="color: red;">(unit is clumps/m2)</span>

- Solanum nigrum: https://www.sciencedirect.com/topics/agricultural-and-biological-sciences/plant-density


**Add carrying capacity data**

```{r}

traits_all <- 
  BB_Species |> 
  merge(SeedNumber, by = "species") |>
  merge(GrowthRate, by = "species") |>
  merge(Wetmass, by = "species") |>
  merge(Dispersal, by = "species") |>
  merge(PDensity, by = "species", all.x = TRUE)
  
unique(traits_all$species)  #check the number of species with data for all traits

print(traits_all)

```


# 2.3 - Final trait table

Calculate the mean and standard deviation for each species for each trait.

```{r}

#select only columns with the values for final table
simplified_traits <- traits_all[,c("species","seed_number","mean_dist_m","max_dist_m","growth_rate_mm","wetmass_g","mortality","density_sqMeter")]

#create final table
final <- simplified_traits[seq_along(unique(simplified_traits$species)),]

#delete data from table
final[TRUE, TRUE] = NA

#add species to column
final$species = unique(simplified_traits$species)

#duplicate trait columns
final <- cbind(final, final[, c(2:8)])

#change names
colnames(final)[2:8] = paste0(colnames(final)[2:8], "_mean")
colnames(final)[9:15] = paste0(colnames(final)[9:15], "_std")


#add traits

for (row in seq_len(nrow(final))) { #for each row (aka species) in the final table
  sp = final$species[row] #get the species name
  sp_rows = simplified_traits[simplified_traits$species == sp,] #get the rows for that species from the simplified_traits dataframe

  for (col in colnames(sp_rows)) { #for each column (aka trait)
    if (col == "species") next #skip species column

    if (length(unique(sp_rows[,col])) == 1) { #if there is only one unique value for that trait
      final[row, paste0(col, "_mean")] = sp_rows[1,col] #the mean is that number
final[row, paste0(col, "_std")] = 0 #the std is 0
    } else { #if there are multiple values
      if (is.character(sp_rows[,col])) { #must be numeric, else stop function
        stop("You have a character value in this column!")
      } else { #if is numeric
        final[row, paste0(col, "_mean")] = mean(sp_rows[,col]) #calculate mean
final[row, paste0(col, "_std")] = sd(sp_rows[,col]) #calculate std
      }
    }
  }
}

print(final)

write.csv(final, "Results/trait_data.csv")

```


# 3 - Occurrence data


```{r}
sp_list <- data.frame(unique(traits$species)) #get species names included in the complete data
names(sp_list) <- 'species' #change column name

```


## Calculate occurrences in Bavaria for each species

Used the same file (GBIF_bav) that was downloaded in Chapter 1.

```{r}

gbif_bav <- merge(sp_list, GBIF_bav, by = "species") #get occurrence data from Bavaria for the species included in the complete data

library(stats) #for aggregate function

occur_sp_bav <- aggregate(numberOfOccurrences ~ species, data=gbif_bav, sum) #calculate number of occurrences for each species

names(occur_sp_bav)[names(occur_sp_bav) == 'numberOfOccurrences'] <- 'numberOfOccurrences_bav' #change column name

```

## Calculate occurrences in BW for each species

Used the same file (GBIF_bav) that was downloaded in Chapter 1.

```{r}

gbif_bw <- merge(sp_list, GBIF_baden, by = "species") #get occurrence data from BW for the species included in the complete data

occur_sp_bw <- aggregate(numberOfOccurrences ~ species, data=gbif_bw, sum) #calculate number of occurrences for each species

names(occur_sp_bw)[names(occur_sp_bw) == 'numberOfOccurrences'] <- 'numberOfOccurrences_bw' #change column name

```

## Calculate occurrences in Bavaria + BW for each species

```{r}

occur <- merge(occur_sp_bav, occur_sp_bw, by = "species", all=TRUE) #merge occurrences from Bavaria and BW

occur$numberOfOccurrences <- rowSums(cbind(occur$numberOfOccurrences_bav,occur$numberOfOccurrences_bw),na.rm=TRUE) #sum occurrences

print(occur)

write.csv(occur, "Results/Occurrences_bav&bw.csv") #download occurrence file

```


## Calculate occurrences worldwide for each species

Go to https://www.gbif.org/occurrence/search?occurrence_status=present&q= to download the species list with occurrences, and use the following filters: 
  - "Scientific name" - "Tracheophyta"
  - "Location" - "Including coordinates"
  
Download - option "species list"

```{r}

GBIF_world <- read.csv(unzip("Data/SpeciesList_Tracheophyta_worldwide.zip"), sep = "\t", quote = "") #read file

gbif_world <- merge(sp_list, GBIF_world, by = "species") #get occurrence data worldwide for the species included in the complete data

occur_sp_ww <- aggregate(numberOfOccurrences ~ species, data=gbif_world, sum) #calculate number of occurrences for each species

print(occur_sp_ww)

write.csv(occur_sp_ww, "Results/Occurrences_worldwide.csv") #download occurrence file

```

# 4 - Map occurrences

Go to https://www.gbif.org/occurrence/search?occurrence_status=present&q= to download the species occurrences with coordinates, and use the following filters: 
  - "Scientific name" - name of the species
  - "Location" - "Including coordinates"
  
Download - option "simple" to include coordinates

```{r}

#import occurrences data with coordinates for each species

list_occur_files <- list.files("Data/Occurrences", full.name = TRUE) #get list of occurrence files

for(file in list_occur_files) { #for each filename
  curr_file <- read.csv(unzip(file), sep = "\t", quote = "")[c("species","decimalLatitude","decimalLongitude","eventDate")] #read file and get only columns with coordinates and date
  if (match(file, list_occur_files) == 1) { #if first file
    occur_latlon <- curr_file #make it the final data object 
  } else {
    occur_latlon <- rbind(occur_latlon,curr_file) #add subsequent files to the final data object
  }
}

```


```{r}
library(sf)
library(ggplot2)

#load shapefile from Bav and BW
south_DE <- read_sf("Data/Spatial/Bav&BW.shp")

#plot the maps for each species

for (sp in unique(occur_latlon$species)) {
  curr_data <- subset(occur_latlon, species == sp) #subset the data for each species
  curr_data_sf <- st_as_sf(curr_data, coords = c("decimalLongitude", "decimalLatitude"), crs = 4326) #convert dataframe to a sf object
  curr_intersect <- st_intersection(curr_data_sf, south_DE) #intersect the species sf object with the shapefile from Bav and BW
  curr_plot <- ggplot() +
    theme(axis.text = element_text(family = 'serif'),
          plot.margin = margin(t = 20,  # Top margin
                             r = 10,  # Right margin
                             b = 10,  # Bottom margin
                             l = 10) # Left margin 
          ) +
    geom_sf(data = south_DE) + #plot Bav and BW map
    geom_sf(data = curr_intersect) #plot species' point data
  assign(sp, curr_plot) #assign to each plot the name of the species
}


#plot maps in a grid

library(cowplot)

plot_grid(`Achillea millefolium`,`Centaurea diffusa`,`Centaurea jacea`,`Galium mollugo`,`Galium verum`,`Medicago lupulina`, nrow = 2, labels = unique(occur_latlon$species)[c(1:6)], label_size = 12)

plot_grid(`Ononis spinosa`,`Papaver dubium`,`Plantago lanceolata`,`Rumex acetosa`,`Salix reticulata`,`Senecio vulgaris`, nrow = 2, labels = unique(occur_latlon$species)[c(7:12)], label_size = 12)

plot_grid(`Solanum nigrum`,`Solidago canadensis`,`Sonchus asper`,`Trifolium pratense`,`Veronica chamaedrys`, nrow = 2, labels = unique(occur_latlon$species)[c(13:17)], label_size = 12)

```

# 4.1 - Maps of selected species

Species with all trait data including carrying capacity.

```{r}

plot_grid(`Achillea millefolium`,`Centaurea diffusa`,`Galium mollugo`,`Salix reticulata`,`Solanum nigrum`,`Solidago canadensis`, nrow = 2, labels = unique(occur_latlon$species)[c(1:2,4,11,13:14)], label_size = 12, label_colour = "darkgreen")

```


<br><br>
<div class="tocify-extend-page" data-unique="tocify-extend-page" style="height: 0;"></div>
